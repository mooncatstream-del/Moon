<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üòº Moon Cat</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <style>
    :root {
      --bg-url: url("https://images.unsplash.com/photo-1663102093386-dcac64bb141f?q=80&w=1287&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D");
    }

    html, body {
      height: 100%;
      margin: 0;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #b00000;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
      overflow-x: hidden;
      background-image: var(--bg-url);
      background-repeat: no-repeat;
      background-position: center center;
      background-size: cover;
      background-attachment: scroll;
      position: relative;
    }
    @media (min-width: 900px) {
      body {
        background-attachment: fixed;
      }
    }
    body::before {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.55);
      z-index: 0;
    }

    h1 { 
      font-size: 2.8rem; 
      margin: 0 0 3rem; 
      transform: translateY(-80px); 
      z-index: 1; 
      position: relative;
      color: #ff4444;
      text-shadow: 0 0 8px rgba(255, 68, 68, 0.8), 0 0 16px rgba(255, 68, 68, 0.5);
      letter-spacing: 3px;
    }

    .button {
      display: block;
      width: 260px;
      margin: 1rem auto;
      padding: 1rem;
      font-size: 1.1rem;
      font-weight: 700;
      color: #fff;
      border-radius: 50px;
      text-decoration: none;
      transition: transform 0.2s;
      position: relative;
      z-index: 1;
      cursor: pointer;
      text-align: center;
      border: none;
      outline: none;
    }
    .button:hover {
      transform: scale(1.05);
    }

    .chat { background: linear-gradient(135deg, #8b0000, #b00000); }
    .channel { 
      background: linear-gradient(270deg, red, orange, yellow, green, cyan, blue, violet, red);
      background-size: 600% 600%;
      animation: rgbShift 15s linear infinite;
    }
    @keyframes rgbShift { 
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .donate { 
      background: linear-gradient(135deg, #0044ff, #00ccff);
      border: 2px solid #00ccff;
      animation: pulse 2s infinite;
    }
    @keyframes pulse { 
      0% { box-shadow: 0 0 10px #00ccff; }
      50% { box-shadow: 0 0 20px #00ccff; }
      100% { box-shadow: 0 0 10px #00ccff; }
    }
    .calculator-btn {
      background: linear-gradient(135deg, #ffcc00, #ff6600);
      animation: rotateGradient 4s linear infinite;
      box-shadow: 0 0 5px rgba(255, 102, 0, 0.5);
    }
    @keyframes rotateGradient {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }

    .calculator-container {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #e8ecef; /* –ë–æ–ª–µ–µ —Ç—ë–º–Ω—ã–π —Å–µ—Ä—ã–π —Ñ–æ–Ω */
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      max-height: 80vh;
      overflow-y: auto;
      width: 90%;
      max-width: 700px;
      border: 2px solid #a3bffa;
      animation: jump 0.5s ease-out;
    }
    .calculator-container.active {
      display: block;
    }
    @keyframes jump {
      from { transform: translate(-50%, -50%) translateY(20px); }
      to { transform: translate(-50%, -50%) translateY(0); }
    }

    .calculator-header-container {
      display: flex;
      align-items: center;
      background: rgba(30, 30, 50, 0.9);
      padding: 20px 25px;
      border-radius: 10px 10px 0 0;
      margin: -25px -25px 25px -25px;
    }

    .calculator-header {
      width: 80%;
      text-align: center; /* –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
      font-size: 2.2em; /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç */
      line-height: 1.5;
      font-family: 'Playfair Display', serif;
      font-weight: 900;
    }
    .calculator-header span {
      background: linear-gradient(45deg, #ff9999, #ffcccc, #ff9999);
      background-size: 200% 200%;
      animation: textGradientShift 5s ease infinite;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .calculator-header .moon-cat {
      background: linear-gradient(45deg, #ff4444, #ff6666, #ff4444); /* –ö—Ä–∞—Å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è Moon Cat */
      background-size: 200% 200%;
      animation: textGradientShift 5s ease infinite;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      white-space: nowrap; /* Moon Cat –Ω–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–∏ */
    }
    @keyframes textGradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .calculator-header::before {
      content: "\f6be"; /* –ò–∫–æ–Ω–∫–∞ –∫–æ—Ç–∏–∫–∞ */
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-right: 10px;
      color: #ff9999;
    }

    .close-calculator {
      background: #ff9999;
      color: #fff;
      border: none;
      padding: 0;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
      width: 20%;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .close-calculator:hover {
      background: #ffcccc;
    }
    .close-calculator::before {
      content: "\f1b0"; /* –õ–∞–ø–∫–∞ */
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-right: 5px;
    }

    .startSelect {
      background: #d1e7dd;
      border: 2px solid #a3bffa;
      padding: 10px;
      border-radius: 10px;
      margin: 5px 0;
      width: 100%;
      color: #333;
      transition: all 0.3s ease;
    }
    .endSelect {
      background: #f8d7da;
      border: 2px solid #a3bffa;
      padding: 10px;
      border-radius: 10px;
      margin: 5px 0;
      width: 100%;
      color: #333;
      transition: all 0.3s ease;
    }
    .startSelect:focus, .endSelect:focus {
      border-color: #7f9cf5;
      box-shadow: 0 0 8px rgba(163, 191, 250, 0.5);
      outline: none;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #333;
      position: relative;
    }
    label::before {
      content: "\f1b0";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-right: 5px;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 10px;
      border: 2px solid #a3bffa;
      color: #333;
      background: #fff;
      transition: all 0.3s ease;
    }
    input[type="text"]:focus {
      border-color: #7f9cf5;
      box-shadow: 0 0 8px rgba(163, 191, 250, 0.5);
      outline: none;
    }
    input[type="text"]::placeholder {
      color: #999;
      font-style: italic;
    }
    input[type="checkbox"] {
      width: auto;
      margin-right: 10px;
      accent-color: #a3bffa;
    }
    button.calc-button {
      margin-top: 20px;
      width: 100%;
      padding: 15px;
      background: linear-gradient(45deg, #a3bffa, #d1e7dd);
      color: #333;
      border: none;
      border-radius: 15px;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      position: relative;
    }
    button.calc-button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px #a3bffa, 0 0 15px #d1e7dd;
    }
    button.calc-button:active {
      transform: scale(0.98);
    }
    button.calc-button::before {
      content: "\f1b0";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-right: 8px;
    }
    button.calc-button::after {
      content: "\f1b0";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-left: 8px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      color: #333;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
    }
    table, th, td {
      border: 1px solid #a3bffa;
    }
    th, td {
      padding: 12px;
      text-align: center;
    }
    th {
      background: #a3bffa;
      color: #fff;
      font-weight: bold;
      position: relative;
    }
    th:nth-child(1)::before { content: "\f1b0 –†–∞–Ω–≥"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
    th:nth-child(2)::before { content: "\f1b0 –ü–æ–¥—Ä–∞–Ω–≥"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
    th:nth-child(3)::before { content: "\f1b0 –ó–≤—ë–∑–¥—ã"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
    th:nth-child(4)::before { content: "\f1b0 –¶–µ–Ω–∞"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
    th:nth-child(5)::before { content: "\f1b0 –ò—Ç–æ–≥–æ"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
    .start { background: #d1e7dd; }
    .middle { background: #fff3cd; }
    .end { background: #f8d7da; }

    .order-btn {
      margin-top: 20px;
      padding: 15px 30px;
      background: linear-gradient(45deg, #ff9999, #ffcccc);
      color: #fff;
      border: none;
      border-radius: 15px;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(255, 153, 153, 0.5);
      position: relative;
    }
    .order-btn:hover {
      background: linear-gradient(45deg, #ffcccc, #ff9999);
      transform: scale(1.05);
      box-shadow: 0 7px 20px rgba(255, 153, 153, 0.7);
    }
    .order-btn::before {
      content: "\f1b0";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-right: 8px;
    }
    .order-btn::after {
      content: "\f1b0";
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      margin-left: 8px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1001;
    }
    .modal-content {
      background: #fff;
      width: 80%;
      max-width: 400px;
      margin: 0 auto;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      position: relative;
      top: 50%;
      transform: translateY(-50%);
    }
    .modal-content p {
      margin: 10px 0;
      font-size: 1.1em;
      color: #333;
    }
    .modal-action-btn {
      margin-top: 20px;
      padding: 10px 20px;
      color: #fff;
      border: none;
      border-radius: 10px;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.1s ease;
    }
    .modal-action-btn:hover {
      transform: scale(1.05);
    }
    .modal-action-btn:active {
      transform: scale(0.98);
    }
    .copy-btn {
      background: #a3bffa;
    }
    .copy-btn:hover {
      background: #7f9cf5;
    }
    .copy-btn.copied {
      background: #90ee90;
      animation: colorFlash 1s ease-out forwards;
    }
    .close-btn {
      background: #ff9999;
    }
    .close-btn:hover {
      background: #ffcccc;
    }
    @keyframes colorFlash {
      0% { background: #90ee90; }
      100% { background: #a3bffa; }
    }
    .result-container {
      overflow-x: auto;
    }
    .total-row {
      background: #2d2d44;
      color: #ff9999;
      padding: 10px;
      border-radius: 5px;
      text-align: center;
      font-weight: bold;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { background: rgba(45, 45, 68, 0.8); }
      50% { background: rgba(45, 45, 68, 1); }
      100% { background: rgba(45, 45, 68, 0.5); }
    }
    @media (max-width: 600px) {
      .calculator-container {
        padding: 15px;
      }
      .calculator-header {
        font-size: 1.7em; /* –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        width: 75%;
      }
      .close-calculator {
        width: 25%;
        height: 50px;
      }
      table {
        font-size: 0.9em;
      }
      .result-container {
        max-width: 100%;
        overflow-x: auto;
      }
      .order-btn {
        padding: 10px 20px;
        font-size: 1em;
      }
    }
  </style>
</head>
<body>

<h1>üòº Moon Cat</h1>

<a href="https://t.me/+J87CaijINuM4OWFi" class="button chat" target="_blank" rel="noopener">üí¨–ù–∞—à —á–∞—Ç–∏–∫ –≤ Telegram</a>
<a href="https://t.me/MoonCatBoost" class="button channel" target="_blank" rel="noopener">üöÄ–ö–∞–Ω–∞–ª –ø–æ –±—É—Å—Ç—É</a>
<a href="https://mooncatstream.donatik.ua" class="button donate" target="_blank" rel="noopener">ü•ôü•û–ü–æ–∫–æ—Ä–º–∏—Ç—å –∫–æ—Ç–∞</a>
<button class="button calculator-btn" onclick="toggleCalculator()">üìä–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü–µ–Ω</button>

<div id="calculator-container" class="calculator-container">
  <div class="calculator-header-container">
    <div class="calculator-header"><span>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±—É—Å—Ç–∞ ML –æ—Ç </span><span class="moon-cat">Moon Cat</span></div>
    <button class="close-calculator" onclick="toggleCalculator()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
  <div class="calculator">
    <label>–°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä–∞–Ω–≥:</label>
    <select id="startRank" class="startSelect" onchange="updateStartBlock()"></select>
    <label id="startSubLabel">–ü–æ–¥—Ä–∞–Ω–≥ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —Ä–∞–Ω–≥–∞:</label>
    <select id="startSub" class="startSelect" onchange="updateEndRankOptions()"></select>
    <label>–ó–≤—ë–∑–¥—ã —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —Ä–∞–Ω–≥–∞:</label>
    <input type="text" id="startStars" class="startSelect" onblur="checkStartStarsText()" placeholder="–ú—è—É, –≤–≤–µ–¥–∏ –∑–≤—ë–∑–¥—ã...">
    <label>–ö–æ–Ω–µ—á–Ω—ã–π —Ä–∞–Ω–≥:</label>
    <select id="endRank" class="endSelect" onchange="updateEndBlock()"></select>
    <label id="endSubLabel">–ü–æ–¥—Ä–∞–Ω–≥ –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ä–∞–Ω–≥–∞:</label>
    <select id="endSub" class="endSelect" onchange="updateEndStars()"></select>
    <label>–ó–≤—ë–∑–¥—ã –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ä–∞–Ω–≥–∞:</label>
    <input type="text" id="endStars" class="endSelect" onblur="checkEndStarsText()" placeholder="–ú—è—É, –≤–≤–µ–¥–∏ –∑–≤—ë–∑–¥—ã...">
    <label><input type="checkbox" id="coop"> –°–æ–≤–º–µ—Å—Ç–Ω—ã–π –±—É—Å—Ç (+5‚Ç¥ –∑–∞ –∑–≤–µ–∑–¥—É)</label>
    <button class="calc-button" onclick="calculate()">–ü–æ—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—É</button>
    <div class="result-container">
      <div id="result"></div>
    </div>
  </div>
  <button class="order-btn" onclick="openModal()">–ó–∞–∫–∞–∑–∞—Ç—å –±—É—Å—Ç</button>
  <div id="orderModal" class="modal">
    <div class="modal-content">
      <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å–æ –º–Ω–æ–π –¥–ª—è –∑–∞–∫–∞–∑–∞:</p>
      <p><strong>@KolllaK2</strong> <button class="modal-action-btn copy-btn" onclick="copyToClipboard(this)">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–≥</button></p>
      <button class="modal-action-btn close-btn" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
</div>

<script>
  const RANKS = ["–≠–ø–∏–∫", "–õ–µ–≥–µ–Ω–¥–∞", "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π", "–ú–∏—Ñ–∏—á–µ—Å–∫–∞—è —á–µ—Å—Ç—å", "–ú–∏—Ñ–∏—á–µ—Å–∫–∞—è —Å–ª–∞–≤–∞"];
  const PRICES = [15, 20, 25, 30, 35];
  const SUBCOUNT = [5, 5, 0, 0, 0];
  const MINSTARS = [0, 0, 0, 25, 50];
  const MAXSTARS = [5, 5, 25, 50, 100];
  const STARS_PER_SUB = 5;
  const STARS_TO_PROMOTE = 1;

  function init() {
    const startRank = document.getElementById('startRank');
    const endRank = document.getElementById('endRank');
    startRank.innerHTML = '';
    endRank.innerHTML = '';
    for (let i = 0; i < RANKS.length; i++) {
      startRank.innerHTML += `<option value="${i}">${RANKS[i]}</option>`;
      endRank.innerHTML += `<option value="${i}">${RANKS[i]}</option>`;
    }
    document.getElementById('startRank').value = 0;
    document.getElementById('endRank').value = 0;
    updateStartBlock();
  }

  function updateStartBlock() {
    const sR = parseInt(document.getElementById('startRank').value);
    const sSub = document.getElementById('startSub');
    const sStars = document.getElementById('startStars');
    if (SUBCOUNT[sR] > 0) {
      sSub.style.display = 'block';
      sSub.innerHTML = '';
      for (let i = SUBCOUNT[sR]; i >= 1; i--) {
        sSub.innerHTML += `<option value="${i}">${i}</option>`;
      }
      sSub.value = SUBCOUNT[sR];
      document.getElementById('startSubLabel').style.display = 'block';
    } else {
      sSub.style.display = 'none';
      document.getElementById('startSubLabel').style.display = 'none';
    }
    sStars.value = "";
    sStars.placeholder = `${MINSTARS[sR]} - ${MAXSTARS[sR]}`;
    updateEndRankOptions();
  }

  function checkStartStarsText() {
    const sR = parseInt(document.getElementById('startRank').value);
    const sStars = document.getElementById('startStars');
    const value = sStars.value.trim();
    if (value !== "") {
      const numValue = parseInt(value);
      if (isNaN(numValue)) {
        sStars.value = MINSTARS[sR];
      } else if (numValue < MINSTARS[sR]) {
        sStars.value = MINSTARS[sR];
      } else if (numValue > MAXSTARS[sR]) {
        sStars.value = MAXSTARS[sR];
      } else {
        sStars.value = numValue;
      }
    } else {
      sStars.value = MINSTARS[sR];
    }
    updateEndRankOptions();
  }

  function updateEndRankOptions() {
    const sR = parseInt(document.getElementById('startRank').value);
    const eR = document.getElementById('endRank');
    const current = parseInt(eR.value);
    eR.innerHTML = '';
    for (let i = sR; i < RANKS.length; i++) {
      eR.innerHTML += `<option value="${i}">${RANKS[i]}</option>`;
    }
    if (current >= sR) eR.value = current; else eR.value = sR;
    updateEndBlock();
  }

  function updateEndBlock() {
    const sR = parseInt(document.getElementById('startRank').value);
    const sSub = (SUBCOUNT[sR] > 0) ? parseInt(document.getElementById('startSub').value || SUBCOUNT[sR]) : 0;
    const sStars = parseInt(document.getElementById('startStars').value || 0);
    const eR = parseInt(document.getElementById('endRank').value);
    const eSubSelect = document.getElementById('endSub');
    const eSubLabel = document.getElementById('endSubLabel');
    const eStarsInput = document.getElementById('endStars');
    if (SUBCOUNT[eR] > 0) {
      eSubSelect.style.display = 'block';
      eSubSelect.innerHTML = '';
      for (let i = SUBCOUNT[eR]; i >= 1; i--) {
        if (eR === sR && i > sSub) continue;
        eSubSelect.innerHTML += `<option value="${i}">${i}</option>`;
      }
      eSubSelect.value = eSubSelect.options.length > 0 ? eSubSelect.options[0].value : 1;
      eSubLabel.style.display = 'block';
    } else {
      eSubSelect.style.display = 'none';
      eSubLabel.style.display = 'none';
    }
    let minEndStars = MINSTARS[eR];
    if (eR === sR && parseInt(eSubSelect.value) === sSub) {
      minEndStars = Math.max(MINSTARS[eR], sStars + 1);
    }
    eStarsInput.value = "";
    eStarsInput.placeholder = `${minEndStars} - ${MAXSTARS[eR]}`;
  }

  function checkEndStarsText() {
    const eR = parseInt(document.getElementById('endRank').value);
    const sR = parseInt(document.getElementById('startRank').value);
    const sSub = (SUBCOUNT[sR] > 0) ? parseInt(document.getElementById('startSub').value || SUBCOUNT[sR]) : 0;
    const sStars = parseInt(document.getElementById('startStars').value || 0);
    const eSub = (SUBCOUNT[eR] > 0) ? parseInt(document.getElementById('endSub').value || 1) : 0;
    const eStarsInput = document.getElementById('endStars');
    const value = eStarsInput.value.trim();
    let minEndStars = MINSTARS[eR];
    if (eR === sR && eSub === sSub) {
      minEndStars = Math.max(MINSTARS[eR], sStars + 1);
    }
    if (value !== "") {
      const numValue = parseInt(value);
      if (isNaN(numValue)) {
        eStarsInput.value = minEndStars;
      } else if (numValue < minEndStars) {
        eStarsInput.value = minEndStars;
      } else if (numValue > MAXSTARS[eR]) {
        eStarsInput.value = MAXSTARS[eR];
   } else {
        eStarsInput.value = numValue;
      }
    } else {
      eStarsInput.value = minEndStars;
    }
  }

  function updateEndStars() {
    checkEndStarsText();
  }

  function calculate() {
    const sR = parseInt(document.getElementById('startRank').value);
    const sSub = (SUBCOUNT[sR] > 0) ? parseInt(document.getElementById('startSub').value || SUBCOUNT[sR]) : 0;
    const sStars = parseInt(document.getElementById('startStars').value || 0);
    const eR = parseInt(document.getElementById('endRank').value);
    const eSub = (SUBCOUNT[eR] > 0) ? parseInt(document.getElementById('endSub').value || 1) : 0;
    const eStars = parseInt(document.getElementById('endStars').value || 0);
    const coop = document.getElementById('coop').checked;
    let total = 0;
    let html = "<table><tr><th></th><th></th><th></th><th></th><th></th></tr>";
    for (let r = sR; r <= eR; r++) {
      let stars = 0;
      let subDisplay = (SUBCOUNT[r] > 0) ? '-' : '-';
      if (SUBCOUNT[r] > 0) {
        let startSub = (r === sR) ? sSub : SUBCOUNT[r];
        let endSub = (r === eR) ? eSub : 1;
        let startStars = (r === sR) ? sStars : 0;
        let endStars = (r === eR) ? eStars : 0;
        if (r === sR && r === eR) {
          let numDivToComplete = startSub - endSub;
          stars = (STARS_PER_SUB - startStars) + (numDivToComplete - 1) * STARS_PER_SUB + endStars;
          subDisplay = `${startSub} ‚Üí ${endSub}`;
        } else if (r === sR) {
          stars = (STARS_PER_SUB - startStars) + (startSub - 1) * STARS_PER_SUB;
          subDisplay = `${startSub} ‚Üí 1`;
        } else if (r === eR) {
          stars = (endSub - 1) * STARS_PER_SUB + endStars;
          subDisplay = `1 ‚Üí ${endSub}`;
        } else {
          stars = SUBCOUNT[r] * STARS_PER_SUB;
          subDisplay = `${SUBCOUNT[r]} ‚Üí 1`;
        }
      } else {
        let startStars = (r === sR) ? sStars : MINSTARS[r];
        let endStars = (r === eR) ? eStars : MAXSTARS[r];
        stars = endStars - startStars;
      }
      if (stars <= 0) continue;
      let price = PRICES[r] + (coop ? 5 : 0);
      let subtotal = stars * price;
      total += subtotal;
      let cls = "middle";
      if (r === sR) cls = "start";
      if (r === eR) cls = "end";
      html += `<tr class="${cls}"><td>${RANKS[r]}</td><td>${subDisplay}</td><td>${stars}</td><td>${price}‚Ç¥</td><td>${subtotal}‚Ç¥</td></tr>`;
    }
    html += "</table>";
    html += `<div class="total-row">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${total}‚Ç¥</div>`;
    document.getElementById('result').innerHTML = html;
  }

  function toggleCalculator() {
    const container = document.getElementById('calculator-container');
    container.classList.toggle('active');
    if (container.classList.contains('active')) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'auto';
    }
  }

  function openModal() {
    const modal = document.getElementById('orderModal');
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
  }

  function closeModal() {
    const modal = document.getElementById('orderModal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
  }

  function copyToClipboard(button) {
    navigator.clipboard.writeText('@KolllaK2').then(() => {
      button.classList.add('copied');
      setTimeout(() => button.classList.remove('copied'), 1000);
    }).catch(err => {
      console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
    });
  }

  document.addEventListener('click', function(event) {
    const modal = document.getElementById('orderModal');
    if (event.target === modal) {
      closeModal();
    }
  });

  window.onload = init;
</script>

</body>
</html>